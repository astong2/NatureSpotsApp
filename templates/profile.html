{% extends 'layout.html' %}
{% block title %}{{ user.username }} | Profile · NatureSpots{% endblock %}

{% block content %}
<div class="profile-card">
  <h2>{{ user.username }}’s Profile</h2>
  <p><strong>Email:</strong> {{ user.email }}</p>
</div>

<div class="profile-section">
  <h3>My Spots</h3>
  {% if user_spots %}
    {% for spot in user_spots %}
      <div class="spot-card">
        <h4><a href="{{ url_for('spot_detail', spot_id=spot.id) }}">{{ spot.title }}</a></h4>
        <p><strong>Location:</strong> {{ spot.location }}</p>
        <p>{{ spot.description }}</p>
        <p><em>Tags:</em> {{ spot.tags }}</p>

        {% if spot.image_url %}
          <img src="{{ spot.image_url }}" alt="Image of {{ spot.title }}" width="280">
        {% endif %}

        {% if session.get('user_id') == spot.user_id %}
          <p>
            <a href="{{ url_for('edit_spot', spot_id=spot.id) }}" class="btn btn-edit">Edit</a>
            &nbsp;
            <form action="{{ url_for('delete_spot', spot_id=spot.id) }}" method="POST" class="inline" onsubmit="return confirm('Delete this spot?');">
              <button type="submit" class="btn btn-delete">Delete</button>
            </form>
          </p>
        {% endif %}
      </div>
      <hr>
    {% endfor %}
  {% else %}
    <p>You haven’t added any spots yet. <a href="{{ url_for('add_spot') }}">Add your first one</a>.</p>
  {% endif %}
</div>

<div class="profile-section">
  <h3>Saved Spots</h3>
  {% if saved_spots %}
    {% for spot in saved_spots %}
      <div class="spot-card">
        <h4><a href="{{ url_for('spot_detail', spot_id=spot.id) }}">{{ spot.title }}</a></h4>
        <p><strong>Location:</strong> {{ spot.location }}</p>
        <p>{{ spot.description }}</p>
        {% if spot.image_url %}
          <img src="{{ spot.image_url }}" alt="Image of {{ spot.title }}" width="280">
        {% endif %}
        {% if session.get('user_id') %}
          <form action="{{ url_for('toggle_save', spot_id=spot.id) }}" method="POST" class="inline">
            <button type="submit" class="btn btn-delete">Unsave</button>
          </form>
        {% endif %}
      </div>
      <hr>
    {% endfor %}
  {% else %}
    <p>No saved spots yet.</p>
  {% endif %}
</div>
{% endblock %}